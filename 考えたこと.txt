仮想DOMの仕組み・順序
・現在表示しているDOM構造をもつ
・変更後のDOMを持つ
・表示と変更後のDOMを比較する
・差があればその部分をレンダーする

仮想DOMはDOM操作の抽象化をする
ネイティブなJavaScriptで書かれている。
-> 新たな技術などではない。設計思想的なやつ
= レンダーはブラウザが搭載しているWebAPI(document.appendなど)を使用する

■開発の流れ
1.DOM操作に必要な最低限の情報を確認
2.その情報をもつオブジェクトを用意
3.ユーザーによる操作でそのオブジェクトの内容を変化させ、変化後のオブジェクトの内容を用いてDOM操作
4.差分を検出できるようにする

最初のレンダリングの際、深さ優先探索する必要ある

2024/12/29
・JSONからHTMLエレメントを作る機構はできた
・次：現在のdom構造と変更後のdom構造をメモリに展開したい(変数にもつ)
・変更の検知をしたい(全探索は効率良くない。変更箇所のみをピンポイントで検知したい)

現状だと全体をリレンダする
差分を検知して一部だけを変更したい(今回はpタグ)
必要な機能
・差分検知
・一部レンダ
  ・domBuilderのdomUnit機能を使えばできそう

 replaceWithで既存の要素と新しい要素の置き換えが可能
 差分検知とレンダリングをより汎用的にする必要あり

2024/12/30
レンダする方法
- 置き換える対象のidと置き換えた後のdomのペアを作成する
- 置き換え
考慮事項
- 全体置き換えの場合(初期化や全ての要素で変化があった場合)
- 新たな要素の追加や既存の要素が削除された場合
  - 親要素・兄弟要素・子孫要素
- idの持ち方：とりあえずhtmlのid属性を使う
実装する機能
- 全体を置き換えられる
- 新たな要素を追加・削除ができる
- 既存の要素の変更は入れ替える
実装方法
- 全体を置き換えられる：置き換え前のidと置き換え後の要素をペアにすればよさそう
  - 初期値用の実装もする
- 削除：置き換え後の要素をnullにする
- 追加：置き換え前のidと置き換え後の要素のペアでできそうかも
- 入れ替え：追加と同様

レンダへの渡し方
- 有向グラフ
  - 再帰処理が楽
  - 幅優先探索？深さ優先？
  - 幅ごとに非同期で深さ優先